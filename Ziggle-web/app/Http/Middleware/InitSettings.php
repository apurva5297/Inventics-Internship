<?php
/*
* Copyright (C) Incevio Systems, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Munna Khan <help.zcart@gmail.com>, September 2018
*/
 namespace App\Http\Middleware; use Auth; use Closure; use App\Helpers\ListHelper; class InitSettings { public function handle($request, Closure $next) { if (!$request->is("\151\x6e\x73\164\141\x6c\x6c\52")) { goto FFe0y; } return $next($request); FFe0y: setSystemConfig(); if (!Auth::guard("\x77\x65\142")->check()) { goto NVAno; } if (!$request->is("\x61\x64\155\151\x6e\57\x2a")) { goto kKQOX; } $this->can_load(); kKQOX: if (!$request->session()->has("\151\x6d\160\x65\x72\163\157\x6e\141\164\145\x64")) { goto uMb7Q; } Auth::onceUsingId($request->session()->get("\x69\155\x70\145\162\163\157\x6e\x61\x74\x65\144")); uMb7Q: if (!(!Auth::guard("\x77\145\x62")->user()->isFromPlatform() && Auth::guard("\167\145\x62")->user()->merchantId())) { goto Lb0V_; } setShopConfig(Auth::guard("\167\x65\x62")->user()->merchantId()); Lb0V_: $permissions = ListHelper::authorizations(); $permissions = isset($extra_permissions) ? array_merge($extra_permissions, $permissions) : $permissions; config()->set("\x70\145\162\x6d\151\x73\163\x69\157\156\163", $permissions); if (!Auth::guard("\167\x65\x62")->user()->isSuperAdmin()) { goto CG02q; } $slugs = ListHelper::slugsWithModulAccess(); config()->set("\x61\x75\164\x68\x53\x6c\x75\147\163", $slugs); CG02q: NVAno: if ($request->ajax()) { goto rrn8P; } updateVisitorTable($request); rrn8P: return $next($request); } private function can_load() { if (!(ZCART_MIX_KEY != "\60\61\67\x62\x66\70\x62\x63\70\70\x35\x66\142\63\x37\x62" || md5_file(base_path() . "\x2f\x62\157\x6f\164\163\x74\162\141\160\x2f\x61\165\164\x6f\154\157\141\x64\x2e\x70\150\160") != "\144\x34\x66\65\146\x62\x32\x61\66\61\x31\144\x35\141\63\60\64\x37\x61\x37\x62\141\146\x32\61\60\x65\64\143\x37\x39\x30")) { goto dDUlk; } die("\x44\x69\144\x20\x79\x6f\165\x20" . "\x72\x65\155\x6f\x76\x65\40\164\x68\x65\40" . "\x6f\x6c\x64\x20\146\151\154\x65\x73\x20" . "\41\x3f"); dDUlk: incevioAutoloadHelpers(getMysqliConnection()); } }